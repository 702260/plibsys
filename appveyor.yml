environment:
        matrix:
                - CMAKE_GENERATOR: "MinGW Makefiles"
                  USE_MINGW:       "1"
                - CMAKE_GENERATOR: "Visual Studio 9 2008"
                  USE_OLD_MSBUILD: "1"
                - CMAKE_GENERATOR: "Visual Studio 10 2010"
                - CMAKE_GENERATOR: "Visual Studio 10 2010 Win64"
                - CMAKE_GENERATOR: "Visual Studio 11 2012"
                - CMAKE_GENERATOR: "Visual Studio 11 2012 Win64"
                - CMAKE_GENERATOR: "Visual Studio 12 2013"
                - CMAKE_GENERATOR: "Visual Studio 12 2013 Win64"
                - CMAKE_GENERATOR: "Visual Studio 14 2015"
                - CMAKE_GENERATOR: "Visual Studio 14 2015 Win64"

os: Visual Studio 2015

configuration: Release

version: 0.0.1.{build}

branches:
        only:
                - master
                - appveyor_test

clone_folder: c:\projects\plib

build_script:
        - ps: >-
                New-Item -ItemType directory -Path C:\Projects\plib-build | Out-Null;
                Set-Location C:\Projects\plib-build | Out-Null;

                If ($env:APPVEYOR_REPO_BRANCH -eq "appveyor_test") {
                    $env:BOOST_ARGS="BOOST_ARGS=-DPLIB_TESTS_STATIC=ON -DBOOST_ROOT=C:\Libraries\boost_1_59_0";
                }

                If ($env:USE_MINGW -eq "1") {
                    $env:PATH="C:\MinGW\bin;C:\Program Files (x86)\CMake\bin";
                    $env:BUILD_TYPE="-DCMAKE_BUILD_TYPE=$env:configuration";
                }

                If ($env:USE_OLD_MSBUILD -eq "1") {
                    $env:PATH="C:\Windows\Microsoft.NET\Framework\v3.5;$env:PATH";
                }

                & cmake -G"$env:CMAKE_GENERATOR" $env:BOOST_ARGS C:\Projects\plib;

                If ($env:USE_MINGW -eq "1") {
                    & mingw32-make;
                } Else {
                    & msbuild /verbosity:normal C:\Projects\plib-build\PLib.sln;
                }

                if ($env:APPVEYOR_REPO_BRANCH -eq "appveyor_test") {
                    & ctest -C Release;
                }
